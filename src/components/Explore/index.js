import NavTop from "components/NavTop"
import PostCard from "components/PostCard"
import PostCardLoader from "components/PostCardLoader"
import { useState } from "react"
import { RotateSpinLoader } from 'react-css-loaders'
import { useSelector } from "react-redux"
import Push from "components/Push"

const Explore = ({ post, getPost }) => {
  const me = useSelector(state => state.me.profile)
  const [loading, setLoading] = useState(false)

  const _getPost = async () => {
    setLoading(true)
    await getPost()
    setTimeout(() => {
      setLoading(false)
    }, 250)
  }

  return (
    <div className="bg-dark-0 min-h-screen pb-6">
      {
        me.id ? (
          <NavTop
            center={
              <h3 className="text-white text-xl font-bold">Explore</h3>
            }
            right={
              <div className="flex items-center">
                {
                  loading ? (
                    <button>
                      <RotateSpinLoader style={{
                        margin: `auto`
                      }} color="#E13128" size={2.8} />
                    </button>
                  ) : (
                      <button onClick={_getPost}>
                        <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <circle cx="16" cy="16" r="16" fill="#E13128" />
                          <path fillRule="evenodd" clipRule="evenodd" d="M20.6548 12.6667L20.1744 12.6667C18.4909 12.6824 17.8079 13.402 16.7075 15.8032C16.5838 16.0738 16.5181 16.2175 16.4565 16.3505C14.9799 19.5408 13.4698 20.9492 10.1667 21.0001H8.5V19.3334L10.1538 19.3335C12.6648 19.2947 13.7072 18.3226 14.944 15.6504C15.0038 15.5212 15.0678 15.3814 15.1923 15.1089C16.5365 12.1758 17.6301 11.0236 20.1667 11.0001H20.6548L19.5774 9.92265L20.7559 8.74414L23.8452 11.8334L20.7559 14.9227L19.5774 13.7441L20.6548 12.6667ZM20.6547 20.9999H20.1665C18.5557 20.985 17.5268 20.5148 16.6461 19.4226C16.9731 18.9525 17.28 18.4307 17.5757 17.857C18.2759 18.9497 18.9685 19.3221 20.1743 19.3333L20.6547 19.3333L19.5773 18.2558L20.7558 17.0773L23.8451 20.1666L20.7558 23.2558L19.5773 22.0773L20.6547 20.9999ZM10.1538 12.6665C11.8518 12.6927 12.8782 13.1457 13.7473 14.2626C14.0205 13.6753 14.292 13.1436 14.572 12.666C13.4983 11.555 12.1585 11.0307 10.1667 11H8.5V12.6666L10.1538 12.6665Z" fill="white" />
                        </svg>
                      </button>
                    )
                }

              </div>
            }
          />
        ) : (
            <div className="sticky top-0 z-20 bg-dark-12 px-4">
              <div className="flex justify-between items-center w-full h-12">
                <div className="w-1/3">
                  <Push href="/" as="/">
                    <a>
                      <svg width="95" height="32" viewBox="0 0 95 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M3.40426 32H7.86478L6.73003 23.2143C11.4843 23.9048 21.5603 24.1857 23.8298 19.7857C26.0993 24.1857 36.1753 23.9048 40.9295 23.2143L39.7948 32H44.2553L47.6596 0L35.2133 3.42857C31.0405 4.47619 23.8298 7.8 23.8298 12.7143C23.8298 7.8 16.619 4.47619 12.4463 3.42857L0 0L3.40426 32ZM6.24104 4.20779C10.7801 5.35064 20.5235 9.46493 22.793 16.7792C20.3821 20.4212 15.4725 20.302 12.4319 20.2266C12.0377 20.2168 11.6732 20.2078 11.3475 20.2078C5.10639 20.2078 5.98738 5.19326 6.24104 4.20779ZM41.4186 4.20779C36.8795 5.35065 27.1361 9.46493 24.8666 16.7792C27.2775 20.4212 32.1871 20.302 35.2277 20.2266C35.6219 20.2168 35.9864 20.2078 36.3121 20.2078C42.5532 20.2078 41.6722 5.19326 41.4186 4.20779Z" fill="white" />
                        <path d="M60.196 11.4481V21.348H50.9668V11.4322L60.196 11.4481ZM59.2219 20.1664L56.3797 12.9651H53.0266V14.0189H54.8468L52.4039 20.1344L53.3779 20.5336L54.2081 18.4259H57.4016L58.2639 20.5496L59.2219 20.1664ZM57.0025 17.388H54.6233L55.8208 14.4021L57.0025 17.388Z" fill="white" />
                        <path d="M70.4462 20.5333L62.0314 21.8905L60.3069 11.1923L68.7376 9.83511L70.4462 20.5333ZM68.5141 19.1601L68.3384 18.0583L64.8735 18.6172L63.8835 12.4857L62.0473 12.7891L62.2229 13.8749L62.9734 13.7471L63.9634 19.8786L68.5141 19.1601Z" fill="white" />
                        <path d="M73.7401 18.9524C74.0701 18.9524 74.4002 18.9311 74.7301 18.8885C75.0601 18.8353 75.3582 18.7395 75.6243 18.6011C75.8905 18.4521 76.1086 18.2499 76.2789 17.9944C76.4493 17.7282 76.5344 17.377 76.5344 16.9405C76.5344 16.4934 76.4173 16.1421 76.1831 15.8867C75.949 15.6206 75.6509 15.4183 75.289 15.2799C74.9271 15.1415 74.5226 15.0564 74.0755 15.0244C73.6283 14.9818 73.1973 14.9606 72.7821 14.9606C72.5586 14.9606 72.3403 14.9659 72.1274 14.9765C71.9252 14.9765 71.7388 14.9765 71.5686 14.9765L71.5367 15.9505L72.0636 15.9825L71.9517 21.5072H72.9257L73.0056 18.9365C73.1334 18.9471 73.2558 18.9524 73.3729 18.9524C73.5007 18.9524 73.6231 18.9524 73.7401 18.9524ZM75.5444 16.9565C75.5444 17.18 75.4966 17.361 75.4008 17.4994C75.3155 17.6271 75.1932 17.7282 75.0335 17.8028C74.8845 17.8773 74.7142 17.9305 74.5226 17.9624C74.3309 17.9837 74.134 17.9944 73.9317 17.9944C73.804 17.9944 73.6656 17.9944 73.5166 17.9944C73.3675 17.9837 73.2025 17.9731 73.0216 17.9624L73.0695 15.9665C73.9211 15.9665 74.5438 16.0251 74.9377 16.1421C75.3422 16.2486 75.5444 16.52 75.5444 16.9565ZM77.5883 22.6249L70.2753 22.4812L70.4509 14.2261L77.764 14.3857L77.5883 22.6249Z" fill="white" />
                        <path d="M85.3295 14.6571L84.9143 22.2736L78.3677 21.9383L78.7669 14.3059L85.3295 14.6571ZM84.1319 15.7429L83.3815 15.711L83.3016 17.6271L81.1779 17.5153L81.2737 15.5992L80.0123 15.5513L79.9484 16.2858L80.4914 16.3018L80.2678 20.3575L81.0023 20.4214L81.1141 18.2498L83.2377 18.3616L83.1259 20.5332L83.8764 20.5651L84.1319 15.7429Z" fill="white" />
                        <path d="M94.6383 10.458L93.6483 19.304L85.3933 18.3938L86.3833 9.53191L94.6383 10.458ZM92.882 18.1543L91.0776 11.448L88.0757 11.0967L87.98 12.0388L89.5927 12.2304L86.7983 17.4358L87.6287 17.8988L88.5867 16.1105L91.4289 16.4139L91.9877 18.4098L92.882 18.1543ZM91.1894 15.4558L89.0497 15.2163L90.4389 12.6615L91.1894 15.4558Z" fill="white" />
                      </svg>
                    </a>
                  </Push>
                </div>
                <div className="w-1/3">
                  <div className="flex items-center justify-center">
                    <button onClick={_getPost}>
                      <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="16" cy="16" r="16" fill="#E13128" />
                        <path fillRule="evenodd" clipRule="evenodd" d="M20.6548 12.6667L20.1744 12.6667C18.4909 12.6824 17.8079 13.402 16.7075 15.8032C16.5838 16.0738 16.5181 16.2175 16.4565 16.3505C14.9799 19.5408 13.4698 20.9492 10.1667 21.0001H8.5V19.3334L10.1538 19.3335C12.6648 19.2947 13.7072 18.3226 14.944 15.6504C15.0038 15.5212 15.0678 15.3814 15.1923 15.1089C16.5365 12.1758 17.6301 11.0236 20.1667 11.0001H20.6548L19.5774 9.92265L20.7559 8.74414L23.8452 11.8334L20.7559 14.9227L19.5774 13.7441L20.6548 12.6667ZM20.6547 20.9999H20.1665C18.5557 20.985 17.5268 20.5148 16.6461 19.4226C16.9731 18.9525 17.28 18.4307 17.5757 17.857C18.2759 18.9497 18.9685 19.3221 20.1743 19.3333L20.6547 19.3333L19.5773 18.2558L20.7558 17.0773L23.8451 20.1666L20.7558 23.2558L19.5773 22.0773L20.6547 20.9999ZM10.1538 12.6665C11.8518 12.6927 12.8782 13.1457 13.7473 14.2626C14.0205 13.6753 14.292 13.1436 14.572 12.666C13.4983 11.555 12.1585 11.0307 10.1667 11H8.5V12.6666L10.1538 12.6665Z" fill="white" />
                      </svg>
                    </button>
                  </div>
                </div>
                <div className="w-1/3">
                  <Push href="/login" as="/login">
                    <a className="text-right">
                      <h3 className="text-white text-xl font-bold">Log in</h3>
                    </a>
                  </Push>
                </div>
              </div>
            </div>
          )
      }

      {
        !loading ? (
          <div className="px-4 pt-6" key={post.id}>
            <PostCard id={post.id} />
          </div>
        ) : (
            <div>
              <div className="px-4 pt-6">
                <PostCardLoader />
              </div>
            </div>
          )
      }


    </div>
  )
}

export default Explore